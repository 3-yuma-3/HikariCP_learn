
### Configuration (knobs, baby!)

HikariCPは、追加で調整することなく、ほとんどのデプロイメントでうまく動作するような、まともなデフォルトが用意されています。<br/>
以下に示す「必須項目」を除き、すべてのプロパティはオプションです。

HikariCPでは、すべての時間値にミリ秒を使用している。

HikariCPは、パフォーマンスと信頼性の両方において、正確なタイマーに依存しています。<br/>
サーバはNTPサーバなどの時刻ソースと同期していることが不可欠です。<br/>
特に、サーバーが仮想マシン内で動作している場合はなおさらです。<br/>
なぜでしょうか？詳しくは [こちら](https://dba.stackexchange.com/questions/171002/choice-of-connection-pooling-library-for-vm-deploys/171020#171020) をご覧ください。<br/>
仮想マシンのクロックを「同期」させるために、ハイパーバイザーの設定に頼ってはいけません。<br/>
仮想マシン内部で時刻ソースの同期を設定してください。<br/>
時間の同期が取れていないことが原因であることが判明した問題についてサポートを求めに来た場合、あなたはTwitterで公衆の面前で嘲笑されるでしょう。<br/>

#### Essentials

**`dataSourceClassName`**

これは、JDBC ドライバが提供する `DataSource` クラスの名前です。<br/>
このクラス名を取得するには、特定の JDBC ドライバのドキュメントを参照するか、[以下の表](https://github.com/brettwooldridge/HikariCP#popular-datasource-class-names) を参照してください。<br/>
注意 XAデータソースはサポートされていません。<br/>
XAには、[bitronix](https://github.com/bitronix/btm) のような本物のトランザクション・マネージャが必要です。<br/>
旧式の "DriverManager "ベースのJDBCドライバ構成で `jdbcUrl` を使用している場合は、このプロパティは必要ないことに注意してください。<br/>
デフォルト：なし

*- or -*

**`jdbcUrl`**

このプロパティは、HikariCPが "DriverManagerベース "の設定を使用するように指示します。<br/>
私たちは、様々な理由（下記参照）からDataSourceベースの構成（上記）の方が優れていると感じていますが、多くのデプロイメントでは大きな違いはほとんどありません。<br/>
このプロパティを "古い "ドライバで使用する場合、`driverClassName` プロパティも設定する必要があるかもしれませんが、まずは設定せずに試してみてください。<br/>
このプロパティが使用されている場合でも、DataSourceプロパティを使用してドライバを構成することができ、実際にはURL自体で指定されたドライバパラメータよりも推奨されることに注意してください。<br/>
デフォルト：なし

***

**`username`**

このプロパティは、基礎となるドライバから接続を取得するときに使用されるデフォルトの認証ユーザ名を設定します。<br/>
DataSourceの場合、`DataSource.getConnection(*username*, password)` を呼び出すことで、非常に決定論的な方法で動作することに注意してください。<br/>
しかし、ドライバベースの構成では、ドライバごとに異なります。<br/>
Driverベースの場合、HikariCPはこの `username`プロパティを使用して、ドライバの `DriverManager.getConnection(jdbcUrl, props)` 呼び出しに渡されるPropertiesに `user` プロパティを設定します。<br/>
これが必要でない場合は、このメソッドを完全にスキップして、例えば `addDataSourceProperty("username", ...)` を呼び出してください。<br/>
デフォルト: none

**`password`**

このプロパティは、基礎となるドライバから接続を取得するときに使用されるデフォルトの認証パスワードを設定します。<br/>
データソースの場合、`DataSource.getConnection(username, *password*)` を呼び出すことで、非常に決定論的な方法で動作することに注意してください。<br/>
しかし、ドライバベースの構成では、ドライバごとに異なります。<br/>
Driverベースの場合、HikariCPはこの `password` プロパティを使用して、ドライバの `DriverManager.getConnection(jdbcUrl, props)` 呼び出しに渡されるPropertiesに `password` プロパティを設定します。<br/>
これが必要でない場合は、このメソッドを完全にスキップして、例えば `addDataSourceProperty("pass", ...)` を呼び出してください。<br/>
デフォルト: none

#### Frequently used

**`autoCommit`**

このプロパティは、プールから返された接続のデフォルトの自動コミット動作を制御します。<br/>
ブール値です。<br/>
デフォルト: true

**`connectionTimeout`**

このプロパティは、クライアント (あなたのことです) がプールからの接続を待機する最大ミリ秒数を制御します。<br/>
接続が利用可能にならないままこの時間を超えると、SQLException がスローされます。<br/>
接続タイムアウトの最低許容値は 250 ミリ秒です。<br/>
デフォルト: 30000 (30秒)

**`idleTimeout`**

このプロパティは、接続がプール内でアイドル状態であることを許可される最大時間を制御します。<br/>
この設定は、`minimumIdle` が `maximumPoolSize` よりも小さく定義されている場合にのみ適用されます。<br/>
アイドルの接続は、プールが `minimumIdle` の接続に達すると、リタイアされません。<br/>
接続がアイドルとしてリタイアされるかどうかは、最大で+30秒、平均で+15秒の変動があります。<br/>
このタイムアウトの前に接続がアイドルとしてリタイアされることはありません。<br/>
値 0 は、アイドル状態の接続がプールから削除されないことを意味します。<br/>
最小許容値は10000ms (10秒)です。<br/>
デフォルト: 600000 (10分)

**`keepaliveTime`**

このプロパティは、HikariCPがデータベースまたはネットワーク・インフラストラクチャによってタイムアウトされるのを防ぐために、接続を維持しようとする頻度を制御します。<br/>
この値は、`maxLifetime` 値より小さくなければなりません。<br/>
「keepalive」は、アイドル状態の接続でのみ発生します。<br/>
指定された接続に対する "keepalive" の時間が来ると、その接続はプールから削除され、"ping" を打たれた後、プールに戻されます。<br/>
「ping」は、JDBC4 `isValid()` メソッドの呼び出し、または `connectionTestQuery` の実行のいずれかです。<br/>
通常、プールの外に出ている時間は、1 桁のミリ秒、あるいはサブミリ秒単位で測定されるはずであり、したがってパフォーマンスへの影響はほとんど、あるいはまったくないはずです。<br/>
最小許容値は 30000 ミリ秒 (30 秒) ですが、分単位の値が最も望ましいです。<br/>
デフォルト：0（無効）

**`maxLifetime`**

このプロパティは、プール内の接続の最大寿命を制御する。<br/>
使用中のコネクションが引退することはなく、クローズされたときにのみ削除されます。<br/>
接続ごとに、プール内の大量消滅を避けるために、わずかな負の減衰が適用されます。<br/>
この値は、データベースやインフラストラクチャが課す接続時間制限よりも数秒短く設定することを強く推奨します。<br/>
値0は、最大寿命なし(無限の寿命)を示し、もちろん `idleTimeout` 設定に従う。<br/>
最小許容値は30000ms（30秒）である。<br/>
デフォルト: 1800000 (30分)

**`connectionTestQuery`**

ドライバがJDBC4をサポートしている場合は、このプロパティを設定しないことを強く推奨する。<br/>
これは、JDBC4 `Connection.isValid() API` をサポートしない "レガシー" ドライバのためです。<br/>
これは、データベースへの接続がまだ生きていることを検証するために、プールから接続が渡される直前に実行されるクエリです。<br/>
再度、このプロパティなしでプールを実行してみてください。<br/>
あなたのドライバがJDBC4に準拠していない場合、HikariCPはエラーをログに記録して知らせます。<br/>
デフォルト：なし

**`minimumIdle`**

このプロパティは、HikariCPがプール内で維持しようとするアイドル接続の最小数を制御します。<br/>
アイドル接続数がこの値を下回り、プール内の総接続数が `maxPoolSize` を下回った場合、HikariCPは迅速かつ効率的に接続を追加するための最善の努力を行います。<br/>
ただし、最大限のパフォーマンスとスパイク需要への対応力を得るためには、この値を設定せず、HikariCPを固定サイズの接続プールとして動作させることを推奨します。<br/>
デフォルト：maximumPoolSizeと同じ

**`maximumPoolSize`**

このプロパティは、アイドル接続と使用中の接続の両方を含め、プールが許容する最大サイズを制御します。<br/>
基本的に、この値はデータベース・バックエンドへの実際の接続の最大数を決定します。<br/>
この値の妥当性は、実行環境によって決定するのが最善です。<br/>
プールがこのサイズに達し、アイドル状態の接続が使用できなくなると、 getConnection() の呼び出しは、タイムアウトする前に `connectionTimeout` ミリ秒までブロックされます。<br/>
プールのサイジングについては、[こちら](https://github.com/brettwooldridge/HikariCP/wiki/About-Pool-Sizing) を参照。<br/>
デフォルト: 10

**`metricRegistry`**

このプロパティは、プログラム構成または IoC コンテナ経由でのみ使用できます。<br/>
このプロパティを使用すると、さまざまなメトリックを記録するためにプールで使用するCodahale/Dropwizard `MetricRegistry` のインスタンスを指定できます。<br/>
詳細については、[Metrics wikiページ](https://github.com/brettwooldridge/HikariCP/wiki/Dropwizard-Metrics) を参照してください。<br/>
デフォルト：なし

**`healthCheckRegistry`**

このプロパティは、プログラム構成または IoC コンテナ経由でのみ使用できます。<br/>
このプロパティでは、現在の健全性情報を報告するためにプールで使用するCodahale/Dropwizard `HealthCheckRegistry` のインスタンスを指定できます。<br/>
詳細については、[ヘルスチェックwikiページ](https://github.com/brettwooldridge/HikariCP/wiki/Dropwizard-HealthChecks) を参照してください。<br/>
デフォルト：なし

**`poolName`**

このプロパティは、接続プールのユーザ定義名を表し、主に、プールおよびプール構成を識別するために、ロギングおよび JMX 管理コンソールに表示されます。<br/>
デフォルト：自動生成

#### Infrequently used

**`initializationFailTimeout`**

このプロパティは、プールに初期接続を正常にシードできなかった場合に、プールを "fail fast" するかどうかを制御する。<br/>
この間、アプリケーション・スレッドはブロックされます。<br/>
このタイムアウトが発生する前に接続を取得できなかった場合、例外がスローされる。<br/>
このタイムアウトは、`connectionTimeout` 期間の後に適用されます。<br/>
値が0（ゼロ）の場合、HikariCPは接続の取得と検証を試みる。<br/>
接続を取得できても検証に失敗した場合は例外が発生し、プールは開始されません。<br/>
しかし、接続を取得できない場合、プールは開始されますが、後で接続を取得するための努力は失敗するかもしれません。<br/>
0 未満の値を指定すると、最初の接続の試みはバイパスされ、プールはバックグラウンドで接続の取得を試みながら直ちに開始される。<br/>
その結果、後で接続を取得する試みは失敗するかもしれない。<br/>
デフォルト: 1

**`isolateInternalQueries`**

このプロパティは、HikariCP がコネクション・アライブ・テストのような内部プール・クエリを独自のトランザクションに分離するかどうかを決定します。<br/>
これらは通常読み取り専用のクエリーであるため、独自のトランザクションにカプセル化する必要はほとんどありません。<br/>
このプロパティは、`autoCommit` が無効な場合にのみ適用されます。<br/>
デフォルト: false

**`allowPoolSuspension`**

このプロパティは、JMX を介してプールを一時停止および再開できるかどうかを制御します。<br/>
これは、特定のフェイルオーバー自動化シナリオに役立ちます。<br/>
プールが一時停止されると、`getConnection()` への呼び出しはタイムアウトせず、プールが再開されるまで保持されます。<br/>
デフォルト：false

**`readOnly`**

このプロパティは、プールから取得した接続がデフォルトで読み取り専用モードであるかどうかを制御します。<br/>
データベースによっては読み取り専用モードの概念をサポートしていないものもあれば、Connection が読み取り専用に設定されているときにクエリの最適化を提供するものもあります。<br/>
このプロパティが必要かどうかは、アプリケーションとデータベースに大きく依存します。<br/>
デフォルト: false

**`registerMbeans`**

このプロパティは、JMX 管理 Beans ("MBeans") が登録されているかどうかを制御します。<br/>
デフォルト：false

**`catalog`**

このプロパティは、カタログの概念をサポートするデータベースのデフォルト・カタログを設定します。<br/>
このプロパティが指定されない場合、JDBC ドライバによって定義されたデフォルト・カタログが使用されます。<br/>
デフォルト：ドライバのデフォルト

**`connectionInitSql`**

このプロパティは、新しい接続が作成されるたびに、その接続をプールに追加する前に実行される SQL 文を設定します。<br/>
このSQLが有効でないか、例外をスローした場合、接続失敗として扱われ、標準の再試行ロジックに従います。<br/>
デフォルト：なし

**`driverClassName`**

HikariCPは、`jdbcUrl` のみに基づいてDriverManagerを介してドライバの解決を試みますが、一部の古いドライバについては、`driverClassName` も指定する必要があります。<br/>
ドライバが見つからなかったことを示す明らかなエラーメッセージが表示されない限り、このプロパティは省略してください。<br/>
デフォルト：なし

**`transactionIsolation`**

このプロパティは、プールから返される接続のデフォルトのトランザクション分離レベルを制御します。<br/>
このプロパティが指定されていない場合、JDBC ドライバによって定義された既定のトランザクション分離レベルが使用されます。<br/>
すべてのクエリに共通する特定の分離要件がある場合にのみ、このプロパティを使用してください。<br/>
このプロパティの値は、`TRANSACTION_READ_COMMITTED`、`TRANSACTION_REPEATABLE_READ` などの `Connection` クラスの定数名です。<br/>
デフォルト: ドライバのデフォルト

**`validationTimeout`**

このプロパティは、接続が有効かどうかをテストする最大時間を制御する。<br/>
この値は、`connectionTimeout` よりも小さい必要があります。<br/>
許容可能な検証タイムアウトの最低値は250ミリ秒です。<br/>
デフォルト：5000

**`leakDetectionThreshold`**

このプロパティは、接続漏れの可能性を示すメッセージがログに記録されるまでに、接続がプールから外れる時間を制御します。<br/>
値 0 は、リーク検出が無効であることを意味します。<br/>
リーク検出を有効にするための許容可能な最低値は 2000 (2 秒) です。<br/>
デフォルト: 0

**`dataSource`**

このプロパティは、プログラム設定またはIoCコンテナ経由でのみ利用可能です。<br/>
このプロパティは、HikariCPがリフレクションによってそれを構築するのではなく、プールによってラップされる `DataSource` のインスタンスを直接設定することを可能にします。<br/>
これは、いくつかの依存性注入フレームワークで有用です。<br/>
このプロパティが指定されると、`dataSourceClassName` プロパティとすべてのDataSource固有のプロパティは無視されます。<br/>
デフォルト：なし

**`schema`**

このプロパティは、スキーマの概念をサポートするデータベースのデフォルト・スキーマを設定します。<br/>
このプロパティを指定しないと、JDBC ドライバによって定義されたデフォルト・スキーマが使用されます。<br/>
デフォルト：ドライバのデフォルト

**`threadFactory`**

このプロパティは、プログラム構成または IoC コンテナ経由でのみ使用できます。<br/>
このプロパティでは、プールで使用されるすべてのスレッドの作成に使用される `java.util.concurrent.ThreadFactory` のインスタンスを設定できます。<br/>
これは、アプリケーション・コンテナによって提供される `ThreadFactory` を通してのみスレッドを作成できる、いくつかの制限された実行環境で必要とされます。<br/>
デフォルト：なし

**`scheduledExecutor`**

このプロパティは、プログラム構成または IoC コンテナ経由でのみ使用できます。<br/>
このプロパティでは、様々な内部スケジュールタスクに使用される `java.util.concurrent.ScheduledExecutorService` のインスタンスを設定することができます。<br/>
`ScheduledThreadPoolExecutor` インスタンスをHikariCPに供給する場合は、`setRemoveOnCancelPolicy(true)` を使用することを推奨します。<br/>
デフォルト：なし
